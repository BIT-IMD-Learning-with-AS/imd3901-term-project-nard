<!-- CREATOR CREDITS -->
<!-- -->

<!DOCTYPE html>
<html>
    <head>
      <meta name="description" content="NARD's Alpha Prototype!">
      
      <!-- DO NOT TOUCH -->
      <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
      <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
      <script src="https://unpkg.com/aframe-environment-component@1.1.0/dist/aframe-environment-component.min.js"></script>
      <!-- DO NOT TOUCH -->

      <link rel="stylesheet" href="/css/user-gesture.css">

      <script>
        // Registering a-scene
        AFRAME.registerComponent('start-experience', {
            init: function () {
              console.log('scene loaded');
              // Fade in
              var player = document.getElementById("player");
              let blocker = document.createElement('a-sphere');
              blocker.setAttribute('radius', '0.05');
              blocker.setAttribute('material', "shader:flat; color: white; opacity: 1.0; side: double");
              blocker.setAttribute('id', "artifact");
              blocker.setAttribute('animation', 'property: material.opacity; from: 1.0; to: 0.0 dur: 500; dir: alternate;');
              player.appendChild(blocker);

              // Camera & canoe animation
              let canoe = document.querySelector('a-scene').querySelector('#canoe');
              let cam = document.querySelector('a-scene').querySelector('#player');
              canoe.setAttribute('animation', "property:position; to: 0 1.127 -40; dur: 50000; easing: linear;");
              cam.setAttribute('animation', "property:position; to: 0 2 -40; dur: 47210; easing: linear;");

              typeWriter();
            }
        });

        var i = 0;
        var part1 = "You have returned all lost artifacts back to its rightful place and brought them peace";
        var part2 = "This is the ending of our story. You got to see the history of the Akwesasne people, the obstacles they overcame, and how they continue to appreciate their culture to this day";
        var part3 = "We hope you enjoyed the Canoe Journey story, ni√°:wen";
        var speed = 50;
        var part = 0;
        var tagHolders = ["narrationPT1", "narrationPT2", "narrationPT3"];

        var txts=[part1, part2, part3];

        function typeWriter() {
          if(part < 3){
            if (i < txts[part].length) {
              document.getElementById(tagHolders[part]).innerHTML += txts[part].charAt(i);
              i++;
              setTimeout(typeWriter, speed);

              if(i == txts[part].length){
                i = 0;
                part++;
              }
            }
          }
        }
        
    </script>

    </head>
    <body>

      <!-- A-SCENE -->
      <a-scene start-experience environment="preset: forest; shadow: true">

          <!-- narration -->
      <div id="narration-info">
        <p class="noselect" id="narrationPT1" style="font-size:110%;"></p>
        <p class="noselect" id="narrationPT2" style="font-size:110%; top: 20%;"></p>
        <p class="noselect" id="narrationPT3" style="font-size:130%; top: 30%;"></p>
      </div>
     
      <a-assets>
          <!--<a-asset-item id="bgMusic"  preload="auto" response-type="arraybuffer" src="assets/The Plight of the Samurai - Traditional Japanese Music.mp3"></a-asset-item>-->
            <a-asset-item id="canoeModel" response-type="arraybuffer" src="assets/canoe/canoe.glb"></a-asset-item>
        </a-assets>

        <!-- RIVER -->
        <!-- depth = wave length, width = width, density = wave intensity -->
        <a-ocean color="#3D8695" depth="15" width="25" density="10" position="0 0.7 -30" ></a-ocean>
        <a-ocean color="#3D8695" depth="15" width="25" density="10" position="0 0.7 -20" ></a-ocean>
        <a-ocean color="#3D8695" depth="15" width="25" density="10" position="0 0.7 -10" ></a-ocean>
        <a-ocean color="#3D8695" depth="15" width="25" density="10" position="0 0.7 3" ></a-ocean>
        <a-ocean color="#3D8695" depth="15" width="25" density="10" position="0 0.7 13" ></a-ocean>
        <a-ocean color="#3D8695" depth="15" width="25" density="10" position="0 0.7 23" ></a-ocean>

        <!-- river floor -->
        <a-plane height="100" width="25" position="0 0.2 0" rotation="-90 0 0" material="color:#2C4E55"></a-plane>

        <!-- canoe -->
        <!--DO NOT CHANGE it's tagname (boat) or id (canoe) -->
        <a-entity boat gltf-model= "#canoeModel" id="canoe" position="0 1.127 34.100" rotation="0 90 0" scale="0.250 0.160 0.140"  material="color:brown"> </a-entity>
        
        <a-entity camera id="player" look-controls position="0 2 30"></a-entity>

      </a-scene>

  </body>
</html>