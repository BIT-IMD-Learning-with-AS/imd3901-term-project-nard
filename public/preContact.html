<!DOCTYPE html>
<html>
    <head>
      <meta name="description" content="NARD's Alpha Prototype!">
      
      <!-- DO NOT TOUCH -->
      <script src="/js/aframe.min.js"></script>
      <script src="js/aframe-environment-component.min.js"></script>
      <script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>
      <script src="https://unpkg.com/super-hands@^2.1.0/dist/super-hands.min.js"></script>
      <script src="https://mixedreality.mozilla.org/ammo.js/builds/ammo.wasm.js"></script>
      <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.min.js"></script>
      <script src="https://unpkg.com/aframe-animation-component@^5.1.2/dist/aframe-animation-component.min.js"></script>

      <script src="/objInteraction.js"></script>
      <script src="./js/fire.js"></script>
      <!-- DO NOT TOUCH -->

      <link rel="stylesheet" href="/css/user-gesture.css">

      <script>
        // Registering a-scene
        AFRAME.registerComponent('precontact-experience', {
          init: function () {
            console.log('scene loaded');

            // Fade in
            var player = document.getElementById("player");
            let blocker = document.createElement('a-sphere');
            blocker.setAttribute('radius', '0.05');
            blocker.setAttribute('material', "shader:flat; color: white; opacity: 1.0; side: double");
            blocker.setAttribute('id', "artifact");
            blocker.setAttribute('animation', 'property: material.opacity; from: 1.0; to: 0.0 dur: 500; dir: alternate;');
            player.appendChild(blocker);

            /* Timer*/
            setTimeout(function () {
              let fadeBlocker = document.querySelector('#artifact');
              fadeBlocker.remove();;
            }, 2000);
          }
        });

        // CLICK EVENTS
        const onClick = (event) => {
          // Returning artifact
          if(event.srcElement.id == "rightfulPlace"){
            console.log("ARTIFACT RETURNED ");

            // Fade out
            var player = document.getElementById("player");
            let blocker = document.createElement('a-sphere');
            blocker.setAttribute('radius', '0.05');
            blocker.setAttribute('material', "shader:flat; color: white; opacity: 0.0; side: double");
            blocker.setAttribute('id', "artifact");
            blocker.setAttribute('animation', 'property: material.opacity; from: 0.0; to: 1.0 dur: 500; dir: alternate;');
            player.appendChild(blocker);

            // Timer before fade out
            setTimeout(function () {
              window.location.replace("http://localhost:8080/returnFromArtifact1.html");
            }, 1500);
          }
        } 
        window.addEventListener('click', onClick);

        // Return Indicator looks at camera
        AFRAME.registerComponent('look-at', {
          schema: { type: 'selector' },
          init: function () {},
          tick: function () {
            this.el.object3D.lookAt(this.data.object3D.position)
          }
        });
      </script>


    </head>
    <body>

      <!-- item description -->
      <div id="timePeriod">
        <p class="noselect" style="font-size:110%;">1500s</p>
      </div>

      <!-- A-SCENE -->
      <a-scene precontact-experience environment="preset: forest; groundTexture:none; groundColor:#5A5918; shadow: true" physics="driver:ammo;">
     
      <a-assets>
        <audio id="river" src="assets/riverSound.wav" preload="auto"></audio>

        <a-asset-item id="cornModel" response-type="arraybuffer" src="/assets/corn_corn_corn/scene.gltf"></a-asset-item>
        <a-asset-item id="birchModel" response-type="arraybuffer"  src="/assets/birchTree/scene.gltf"></a-asset-item>
        
        <a-image src="/assets/glow.png"></a-image>
        
        <a-asset-item id="FirePitStand" response-type="arraybuffer" src="assets/FirePitStand/FirePitStand.glb"></a-asset-item>
        <a-asset-item id="PitRocks" response-type="arraybuffer" src="assets/PitRocks/scene.gltf"></a-asset-item>
        <a-asset-item id="diamond" response-type="arraybuffer" src="assets/block_shape_diamond/scene.gltf"></a-asset-item>
        <a-asset-item id="rattleModel" response-type="arraybuffer" src="assets/turtle_rattle/Untitled.gltf"></a-asset-item>
        <a-asset-item id="pineModel" response-type="arraybuffer" src="assets/pine/scene.gltf"></a-asset-item>
        <a-asset-item id="longhouse" response-type="arraybuffer" src="assets/Longhouse_Model/Longhouse.gltf"></a-asset-item>
        <a-asset-item id="pot" response-type="arraybuffer" src="assets/pot/Pot.glb"></a-asset-item>
        <a-asset-item id="dryingRack" response-type="arraybuffer" src="assets/dryingRack/dryingRack.glb"></a-asset-item>
        <a-asset-item id="animalSkin" response-type="arraybuffer" src="assets/animalSkin/animalSkin.glb"></a-asset-item>
        <a-asset-item id="woman" response-type="arraybuffer" src="assets/nymph/Untitled.gltf"></a-asset-item>
        <a-asset-item id="woman2" response-type="arraybuffer" src="assets/nymph_2/Untitled.gltf"></a-asset-item>
        <a-asset-item id="cornCrop" response-type="arraybuffer" src="assets/corn/scene.gltf"></a-asset-item>
        <a-asset-item id="dirt" response-type="arraybuffer" src="assets/dirt/scene.gltf"></a-asset-item>
      </a-assets>

      <a-entity camera id="player" position="4 2 20" wasd-controls look-controls >
        <a-entity cursor id="cameraDot" position="0 0 -1"
                  geometry="primitive: sphere; radius:0.008"
                  material="color:black; shader:flat; opacity:0.5"></a-entity>
        <a-entity gltf-model= "#rattleModel" id="holdingArtifact" position="-0.5 -0.2 -0.5" rotation="-20 90 70" scale="0.2 0.2 0.2"></a-entity>
      </a-entity>

      <!-- rightful place -->
      <a-box id="rightfulPlace" scale="0.7 0.7 0.7" position="0 0.5 -5" material="color:#654321" blessing>
        <a-entity gltf-model= "#diamond" position="-0.1 0.7 0" scale="0.003 0.003 0.003"
        animation="property:position.y; loop: true; dir:alternate; dur:1000; to:1; easing:easeInOutQuad;"></a-animation>
        </a-entity>
      </a-box>
      
      <!-- Pine trees -->
      <a-entity gltf-model="#pineModel" position="1 0 -27" rotation="0 0 0" scale="" value="Pine tree" object-info blessing></a-entity>
      <a-entity gltf-model="#pineModel" position="-10 0 -30" rotation="0 0 0" scale="" value="Pine tree" object-info blessing></a-entity>
      <a-entity gltf-model="#pineModel" position="20 0 -25" rotation="0 0 0" scale="2 3 2" value="Pine tree" object-info blessing></a-entity>
      <a-entity gltf-model="#pineModel" position="40 0 20" rotation="0 0 0" scale="2 3 2" value="Pine tree" objectfo blessing></a-entity>
      <a-entity gltf-model="#pineModel" position="-30 0 15" rotation="0 0 0" scale="1 2 1" value="Pine tree" object-info blessing></a-entity>
      <a-entity gltf-model="#pineModel" position="-33.373 0 -1.378" rotation="0 0 0" scale="3 4 3" value="Pine tree" object-info blessing></a-entity>
      <a-entity gltf-model="#pineModel" position="5 0 -25" rotation="0 0 0" scale="2 3 2" value="Pine tree" object-info blessing></a-entity>
      <a-entity gltf-model="#pineModel" position="-18.882 0 -5" rotation="0 0 0" scale="2 3 2" value="Pine tree" object-info blessing></a-entity>
      <a-entity gltf-model="assets/pine/scene.gltf" position="34.12545 0 -18.49723" rotation="" scale="3 4 3" value="Pine tree" object-info="" blessing=""></a-entity>
      <a-entity gltf-model="assets/pine/scene.gltf" position="33.38898 0 -35.44546" rotation="" scale="3 4 3" value="Pine tree" object-info="" blessing=""></a-entity>
      <a-entity gltf-model="assets/pine/scene.gltf" position="25.77786 0 -48.92235" rotation="" scale="3 6 3" value="Pine tree" objectfo="" blessing=""></a-entity>
      <a-entity gltf-model="#pineModel" position="10 0 -22" rotation="0 0 0" scale="3 4 3" value="Pine tree" object-info blessing></a-entity>
      <a-entity gltf-model="#pineModel" position="14 0 -35" rotation="0 0 0" scale="2 3 2" value="Pine tree" object-info blessing></a-entity>
      <a-entity gltf-model="#pineModel" position="-10 0 -40" rotation="0 0 0" scale="3 6 3" value="Pine tree" blessing></a-entity>

      <a-entity sound="src: #river"></a-entity>


      <a-entity gltf-model="#woman2" position="-1 0.3 -2" rotation="0 45 0" scale="0.003 0.003 0.003"></a-entity>
      <a-entity gltf-model="#woman" position="0 0 -2" rotation="0 0 0" scale="0.003 0.003 0.003"></a-entity>
      <!-- LongHouse -->
      <a-entity gltf-model="#longhouse" position="-10 0.064 -5" scale="2 2 2"rotation="0 90 0" scale=""></a-entity>
      <a-entity gltf-model="#longhouse" position="-11.410 0.309 18.222" scale="1.5 1.5 2"rotation="0 -180 0" scale=""></a-entity>

      <!-- Drying rack  
      <a-box id="drying-rack" position="-2.98665 1 -11" scale="2.5 0.1 0.1" rotation="30.0000701530499 -47.761761802105426 -120.0002806121996" color="brown" material="" geometry=""></a-box>
      <a-box id="drying-rack" position="-1.4765 1 -11" scale="2.5 0.1 0.1" rotation="30.0000701530499 -48.814858229555874 -120.0002806121996" color="brown" material="" geometry=""></a-box>
      <a-box id="drying-rack" position="-1.67595 1 -10.10107" scale="2.5 0.1 0.1" rotation="30.0000701530499 130.46191699349333 -120.0002806121996" color="brown" material="" geometry=""></a-box>
      <a-box id="drying-rack" position="-3.02306 1 -10.1059" scale="2.5 0.1 0.1" rotation="30.0000701530499 129.5824267779675 -120.0002806121996" color="brown" material="" geometry=""></a-box>
      <a-box id="drying-rack" position="-2.36162 1.63557 -11.58017" scale="5 0.1 0.1" rotation="28.86504076089574 -179.99182655137244 -0.0469825392007275" color="brown" material="" geometry=""></a-box>-->

      <!-- FIRE -->
      <a-entity position="0 0 4">
        <!-- fire particles -->
        <a-entity fire="particles: 500;" position="0.0 -0.2 -4" scale="1.2 1.2 1.2"></a-entity>
        <!-- fire light -->
        <a-entity position="0 1.5 -4">
            <a-entity light="type: point; color: #FFA2 0; intensity: 1.5; distance: 10.0;"></a-entity>
        </a-entity>
      </a-entity>

      <a-entity  gltf-model= "#FirePitStand" id="FireStand" position="0 0 0" rotation="0 -180 0" scale="0.330 0.300 0.340"  material="color:brown"> </a-entity>
      <!-- Firepit Stand  -->
      <a-entity gltf-model= "#PitRocks" id="PitRocks" position="0.473 0.324 0.162" rotation="0 -180 0" scale="-0.003 -0.003 -0.003"> </a-entity>
      <a-entity gltf-model= "#pot" id="pot" position="-0.035 0.155 0.162" rotation="0 -72.573 -179.76" scale="-0.206 -0.206 -0.206"> </a-entity>

      <!-- DRYING RACK -->
      <a-entity gltf-model= "#dryingRack" id="dryingRack" position="7.010 0.238 -13.814" rotation="0 -56.778 0" scale="0.330 0.300 0.340" > </a-entity>

     <!-- ANIMAL SKINDRYING RACK -->
     <a-entity gltf-model= "#animalSkin" id="animalSkin" position="7.010 0.238 -13.814" rotation="0 -56.778 0" scale="0.330 0.300 0.340" > </a-entity>


      <!-- Corn crops 
      <a-box id="dirt" position="7.67522 -0.00668 2.29527" scale="5.21325 0.6372 0.36644" rotation="90 92.14502 -178.3680641599717" color="#4C1408" material="" geometry="primitive: sphere"></a-box>
      <a-box id="dirt" position="18.712 -0.007 2.295" scale="5.21325 0.6372 0.36644" rotation="90 92.14502 -178.3680641599717" color="#4C1408" material="" geometry="primitive: sphere"></a-box>
      <a-box id="dirt" position="9.67522 -0.00668 2.29527" scale="5.21325 0.6372 0.36644" rotation="90 92.14502 -178.3680641599717" color="#4C1408" material="" geometry="primitive: sphere"></a-box>
      
      
      <a-box id="dirt" position="13.94939 -0.00668 -7.47844" scale="4.21325 0.6372 0.36644" rotation="90.00021045914971 -59.20143713968744 0" color="#4C1408" material="shader: standard; roughness: 1;" geometry="primitive: sphere"></a-box>
      <a-entity gltf-model="#cornModel" position="12.377 -0.00668 -10.183"></a-entity>
      <a-entity gltf-model="#cornModel" position="13.316 -0.05105 -8.775"></a-entity>
      <a-entity gltf-model="#cornModel" position="14.088 -0.05105 -7.467"></a-entity>
      <a-entity gltf-model="#cornModel" position="14.851 -0.05105 -6.223"></a-entity>-->
      <!-- <a-entity id="birchTree" gltf-model="#cornModel" blessing></a-entity> -->
      <!-- Set attribute below if above object is clicked -->
      <!-- <a-sphere material="color: yellow; opacity: 0.2; dithering: false; shader: flat; blending: additive; src: assets/glow.png" scale="0.5 10 0.1" position="0 4 -14" ></a-sphere>
       -->
      
      
       <!-- Corn crops dirt -->
      <a-entity  gltf-model= "#dirt" id="dirt1" position="17.049 0.324 -9.14" rotation="0 -180 0" scale="-2.024 -2.024 -2.024"> </a-entity>
      <a-entity  gltf-model= "#dirt" id="dirt2" position="17.049 0.324 -5.484" rotation="0 -180 0" scale="-2.024 -2.024 -2.024"> </a-entity>
     
      <a-entity gltf-model= "#dirt" id="dirt3" position="17.049 0.324 -1.828" rotation="0 -180 0" scale="-2.024 -2.024 -2.024"> </a-entity>
      <a-entity gltf-model= "#dirt" id="dirt4" position="17.049 0.324 1.828" rotation="0 -180 0" scale="-2.024 -2.024 -2.024"> </a-entity>
      <a-entity gltf-model= "#dirt" id="dirt5" position="17.049 0.324 5.484" rotation="0 -180 0" scale="-2.024 -2.024 -2.024"> </a-entity>
      <a-entity gltf-model= "#dirt" id="dirt6" position="17.049 0.324 9.14" rotation="0 -180 0" scale="-2.024 -2.024 -2.024"> </a-entity>
      
       <!-- Corn crops -->
      <a-entity gltf-model= "#cornCrop" id="corn1" position="15.887 0.375 3.411" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="corn2" position="15.887 0.375 1.870" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="corn3" position="15.887 0.375 0.186" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="corn4" position="15.887 0.375 -1.393" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="corn5" position="15.887 0.375 -2.946" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>

      <a-entity gltf-model= "#cornCrop" id="cornE5" position="15.887 0.375 -4.499" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornE6" position="15.887 0.375 -6.052" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornE7" position="15.887 0.375 -7.605" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornE8" position="15.887 0.375 -9.068" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornE9" position="15.887 0.375 -6.052" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornE10" position="15.887 0.375 -10.484" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      
      <a-entity gltf-model= "#cornCrop" id="cornN5" position="15.887 0.375 4.499" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornN6" position="15.887 0.375 6.052" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornN7" position="15.887 0.375 7.605" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornN8" position="15.887 0.375 9.068" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornN9" position="15.887 0.375 6.052" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornN10" position="15.887 0.375 10.484" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>

      <a-entity gltf-model= "#cornCrop" id="corn7" position="18.493 0.375 -2.946" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="corn8" position="18.493 0.375 3.411" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="corn9" position="18.493 0.375 1.870" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="corn10" position="18.493 0.375 0.186" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="corn11" position="18.493 0.375 -1.393" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>

      <a-entity gltf-model= "#cornCrop" id="cornE5" position="18.493 0.375 -4.499" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornE6" position="18.493 0.375 -6.052" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornE7" position="18.493 0.375 -7.605" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornE8" position="18.493 0.375 -9.068" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornE9" position="18.493 0.375 -6.052" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornE10" position="18.493 0.375 -10.484" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      
      <a-entity gltf-model= "#cornCrop" id="cornN5" position="18.493 0.375 4.499" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornN6" position="18.493 0.375 6.052" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornN7" position="18.493 0.375 7.605" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornN8" position="18.493 0.375 9.068" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornN9" position="18.493 0.375 6.052" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>
      <a-entity gltf-model= "#cornCrop" id="cornN10" position="18.493 0.375 10.484" rotation="0 0 180" scale="-1.194 -1.194 -1.194"> </a-entity>

    </a-scene>
  </body>
</html>