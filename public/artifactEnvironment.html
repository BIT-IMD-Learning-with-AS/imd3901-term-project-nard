<!DOCTYPE html>
<html>
    <head>
      <meta name="description" content="NARD's Alpha Prototype!">
      
      <!-- DO NOT TOUCH -->
      <script src="/js/aframe.min.js"></script>
      <script src="js/aframe-environment-component.min.js"></script>
      <script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>
      <script src="https://unpkg.com/super-hands@^2.1.0/dist/super-hands.min.js"></script>
      <script src="https://mixedreality.mozilla.org/ammo.js/builds/ammo.wasm.js"></script>
      <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.min.js"></script>
      <!-- DO NOT TOUCH -->

      <link rel="stylesheet" href="/css/user-gesture.css">

      <script>
        // Registering a-scene
        AFRAME.registerComponent('explore-experience', {
          init: function () {
            console.log('scene loaded');
            artifactFound = false;
          }
        });
        
        // BUTTON start experience
        const startExperience = function() {
          document.querySelector('#item-overlay').style.display='none';
        }
        
        var artifactFound;

        // CLICK EVENTS
        const onClick = (event) => {
          // Finding artifact
          if(event.srcElement.id == "artifact"){
            console.log("ARTIFACT FOUND")
            artifactFound = true;
            event.srcElement.parentElement.removeChild(event.srcElement);
            var element = document.getElementById('collectedItem');
            element.style.opacity = "0.9";
            element.style.filter  = 'alpha(opacity=90)';
            window.location.replace("http://localhost:8080/preContact.html"); 
          }
        } 
        window.addEventListener('click', onClick);
      </script>

    </head>
    <body>

      <!-- BUTTON EXPERIENCE -->
      <div id="collectedItem" style="position:absolute; bottom:0px; left:1vw; z-index:1000; opacity: 0;">
        <img src="assets/box.png" width="150" height="150">
      </div>

      <div id="item-overlay">
        <img id="item" src="assets/box.png">
        <p id="itemInfo">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt 
          ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi 
          ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum 
          dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia 
          deserunt mollit anim id est laborum.
        </p>
        <div class="center">
          <button id="item-button" onclick="startExperience();">okay</button>
        </div>
      </div>

      <!-- A-SCENE -->
      <a-scene explore-experience environment="preset: forest; shadow: true" physics="driver:ammo;">
     
        <a-assets>
          <a-asset-item id="totemModel" response-type="arraybuffer" src="assets/small_totem/scene.gltf"></a-asset-item>
        </a-assets>

        <a-entity gltf-model= "#totemModel" id="artifact" ammo-body="type:kinematic; emitCollisionEvents: true" ammo-shape="type:box" position="0 0.5 -10" scale="0.5 0.5 0.5"></a-entity>

      <!-- river -->
      <a-plane height="100" width="200" position="0 0.3 50" rotation="-90 0 0" material="color:lightblue"></a-plane>

      <!-- canoe -->
      <a-box boat id="canoe" ammo-body="type:kinematic; emitCollisionEvents: true" ammo-shape="type:box"  position="0 0.2 0" scale="1 1 3" material="color:brown"> </a-box>
      
      <!-- DO NOT TOUCH camera -->
      <a-entity progressive-controls></a-entity>
      <a-camera >
        <a-entity cursor position="0 0 -1"
                  geometry="primitive: sphere; radius:0.008"
                  material="color:black; shader:flat; opacity:0.5"></a-entity>
      </a-camera>

    </a-scene>
  </body>
</html>